import{r as c,bu as j,u as S,aU as k,j as m,B as E,P as K,bv as M,Z as C,m as I,n as N,q as P,a8 as T,cl as b,aK as D,cm as L,cn as _,aL as p,co as A,cp as J}from"./index-Dl23e-b0.js";const R=D({actions:A(J),collections:A(p()),description:p().optional(),value:p().optional(),value_prefix:p().optional(),expires_at:_().optional(),autodelete:L().optional()}),w=u=>{const[l,y]=I(),n=S(),{onSuccess:d,onError:r,...g}=u||{};return N({...g,mutationFn:t=>l.keys().create(t),onSuccess:(t,o)=>{n.success("API key created",{id:"new-api-key"}),P.invalidateQueries({queryKey:T.all(y)}),d&&d(t,o,{})},onError:(t,o,h)=>{let f=t.message||"an error occurred";n.error(f,{id:"new-api-key"}),r&&r(t,o,h)}})},B={description:"Admin key",actions:["*"],collections:["*"]},U=b(R),F=({defaultValue:u=JSON.stringify(B),options:l,...y})=>{const n=c.useRef(null),d=c.useRef(null),{mode:r,systemMode:g}=j(),t=r==="system"?g:r,[o,h]=c.useState([]),f=S(),i=w({onSuccess:()=>{var e;(e=n.current)==null||e.setValue(u),setTimeout(()=>{var a,s;(s=(a=n.current)==null?void 0:a.getAction("editor.action.formatDocument"))==null||s.run()},100)}}),x=c.useMemo(()=>({...k,...l,readOnly:!!i.isPending}),[l,i.isPending]),v=(e,a)=>{n.current=e,d.current=a,setTimeout(()=>{var s;(s=e.getAction("editor.action.formatDocument"))==null||s.run(),a.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"",fileMatch:["*"],schema:U}]})},200)},O=c.useCallback(()=>{var s;let e=(s=n.current)==null?void 0:s.getValue();if(!e)return;let a=JSON.parse(e);if(o.length){f.warn("Invalid JSON",{id:"monaco-validation"});return}i.mutate(a)},[i.mutate]);return m.jsxs(E,{children:[m.jsx(K,{children:m.jsx(M,{height:"260px",defaultLanguage:"json",theme:t==="light"?"vs-light":"vs-dark",onMount:v,defaultValue:u,onValidate:e=>{h(e)},options:x,...y})}),m.jsx(C,{variant:"contained",onClick:O,disabled:!!o.length||i.isPending,sx:{my:2},children:"Create API Key"})]})};export{F as default};
